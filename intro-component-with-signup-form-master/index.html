<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./style.css">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">

  <title>Frontend Mentor | Intro component with sign up form</title>
</head>
<body>

  <main>
    <div>
      <h1>Learn to code by watching others</h1>

      <p>
        See how experienced developers solve problems in real-time. Watching scripted tutorials is great,
        but understanding how developers think is invaluable.
      </p>

      <div class="badge">
        Try it free 7 days then $20/mo. thereafter
      </div>

    </div>
    <div>
      <form action="" id="form">
        <div class="form_group">
          <input type="text" id="fname" placeholder="first name">
          <small class="err"></small>
        </div>

        <div class="form_group">
          <input type="text" id="lname" placeholder="Last name">
          <small class="err"></small>
        </div>

        <div class="form_group">
          <input type="email" id="email" placeholder="email">
          <small class="err"></small>
        </div>

        <div class="form_group">
          <input type="password" id="pass" placeholder="password">
          <small class="err"></small>
        </div>

        <button type="submit" class="green">Claim your free trial</button>
        <span>By clicking the button, you are agreeing to our <a href="#">Terms and Services</a>  </span>
      </form>
    </div>
  </main>


  <script>
    const form = document.querySelector("#form");
    const fname = document.querySelector("#fname");
    const lname = document.querySelector("#lname");
    const email = document.querySelector("#email");
    const pass = document.querySelector("#pass");

    const isEmpty = (f) => {
      return f.value.trim() === "" ? true: false;
    }

    const isValid = (f) => {

      if (isEmpty(f)) return {
        "state": false,
        "err": `${f.placeholder} cannot be empty`
      }

      if (f.id === "email") {
        let v = "/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:[a-zA-Z0-9-]+)*$/".test(f.value.trim())
        if (!(v)) {
          return {
            "state": false,
            "err": `please enter valid email`
          }
        }

        return {
          "state": true,
          "err": ""
        }
      }
    }

      form.addEventListener("submit", e=> {
        e.preventDefault();

        const {state: validFname, err: fnms }= isValid(fname);
        const {state: validLname, err: lnms} = isValid(lname);
        const {state: validEmail, err: emailms} = isValid(email);
        const {state: validPass, err: psms }= isValid(pass);
        
        fnms ? fname.nextElementSibling.innerText = fnms : fname.nextElementSibling.innerText = "";
        lnms ? lname.nextElementSibling.innerText = fnms : lname.nextElementSibling.innerText = "";
        emailms ? email.nextElementSibling.innerText = emailms : email.nextElementSibling.innerText = "";
        psms ? pass.nextElementSibling.innerText = psms : pass.nextElementSibling.innerText = "";
        
        
        if (validFname && validLname && validEmail && validPass) {
          form.submit();
        }
      })

    </script>

  </body>
</html>